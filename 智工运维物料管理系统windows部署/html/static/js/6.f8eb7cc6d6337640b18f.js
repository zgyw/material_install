webpackJsonp([6],{Luq1:function(e,t){},NYsV:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){return{labelPosition:"right",orderArr:[],classificationOptions:[],materielForm:{classifyId:"",code:"",potting:"",factoryModel:"",quantity:"",model:"",brand:"",supplier:"",website:"",remarks:"",price:"",orderId:"",photo:""},materielRules:{code:[{required:!0,message:"编码不能为空",trigger:"blur"}],classifyId:[{required:!0,message:"分类不能为空",trigger:"blur"}],quantity:[{required:!0,message:"数量不能为空",trigger:"blur"}],orderId:[{required:!0,message:"订单不能为空",trigger:"change"}]},imageUrl:"",materielFile:"",isDialogImport:!1,importForm:{file:""}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(isNaN(t.materielForm.quantity))return void t.$message.error("数量只能是数值类型");var i={code:t.materielForm.code,classifyId:t.materielForm.classifyId,potting:t.materielForm.potting,quantity:parseInt(t.materielForm.quantity),model:t.materielForm.model,brand:t.materielForm.brand,supplier:t.materielForm.supplier,website:t.materielForm.website,price:t.materielForm.price,remarks:t.materielForm.remarks,factoryModel:t.materielForm.factoryModel,orderId:t.materielForm.orderId},r=new FormData;for(var a in t.materielFile&&r.append("file",t.materielFile),i)r.append(a,i[a]);t.$postForm("/materielLevel/putInWare",r).then(function(e){0==e.code?(t.$notify({title:"成功",message:"新增物料成功",type:"success"}),t.materielForm={},t.materielForm.classifyId=t.classificationOptions[0].id,t.materielForm.orderId=t.orderArr[0].id,t.imageUrl=""):t.$message.error(e.msg)})}})},resetForm:function(e){this.$refs[e].resetFields(),this.materielForm={},this.materielForm.classifyId=this.classificationOptions[0].id,this.materielForm.orderId=this.orderArr[0].id,this.imageUrl=""},exportModel:function(){var e=this;this.$getFile("/materielLevel/exportTemplate").then(function(t){console.log(t),console.log(t.data);var i=document.createElement("a"),r=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"});i.style.display="none",i.href=window.URL.createObjectURL(r);var a=window.decodeURI(t.headers["content-disposition"].match(/=(.*)$/)[1]);i.setAttribute("download",a),document.body.appendChild(i),i.click(),document.body.removeChild(i),e.$notify({title:"成功",message:"模板下载成功",type:"success"})}).catch(function(t){e.$message.error("模板下载失败")})},openDialog:function(){this.importForm.file="",this.isDialogImport=!0},importNewMaterial:function(){var e=this;if(this.importForm.file){var t=new FormData;t.append("file",this.importForm.file),this.$postForm("/materielLevel/importMateriel",t).then(function(t){0==t.code?(e.$notify({title:"成功",message:"导入文件成功",type:"success"}),e.importForm.file="",e.materielForm.classifyId=e.classificationOptions[0].id,e.materielForm.orderId=e.orderArr[0].id,e.isDialogImport=!1):e.$message.error(t.msg)}).catch(function(t){e.$message.error("导入文件出错")})}else this.$message.error("请选择文件之后再进行导入!!!")},beforeAvatarUpload:function(e){console.log(e.size);var t=e.size/1024/1024/10<2;return t||this.$message.error("上传物料图片大小不能超过 200kb!"),t},fileChange:function(e){console.log(e),this.materielFile=e.raw,this.imageUrl=URL.createObjectURL(e.raw)},fileChangeT:function(e){this.importForm.file=e.raw},getInOrder:function(){var e=this;this.orderArr=[],this.$get("/orderRecords/findByType",{type:1}).then(function(t){0==t.code&&(e.orderArr=t.data,t.data.length>0&&(e.materielForm.orderId=t.data[0].id))})},getClassifyList:function(){var e=this;this.classificationOptions=[],this.$get("/classify/findAll").then(function(t){if(0==t.code){for(var i=0;i<t.data.length;i++){var r={};r.id=t.data[i].id,r.name=t.data[i].name,e.classificationOptions.push(r)}t.data.length>0&&(e.materielForm.classifyId=t.data[0].id)}})}},created:function(){this.getInOrder(),this.getClassifyList()}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"header-line"}),e._v(" "),i("div",{staticClass:"rule-form"},[i("el-form",{ref:"materielForm",staticClass:"demo-ruleForm",attrs:{"label-position":e.labelPosition,model:e.materielForm,rules:e.materielRules,inline:!1,"label-width":"auto"}},[i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"所属订单",prop:"orderId"}},[i("el-select",{attrs:{placeholder:"请选择订单"},model:{value:e.materielForm.orderId,callback:function(t){e.$set(e.materielForm,"orderId",t)},expression:"materielForm.orderId"}},e._l(e.orderArr,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"分类:",prop:"classifyId"}},[i("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.materielForm.classifyId,callback:function(t){e.$set(e.materielForm,"classifyId",t)},expression:"materielForm.classifyId"}},e._l(e.classificationOptions,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"编码",prop:"code"}},[i("el-input",{model:{value:e.materielForm.code,callback:function(t){e.$set(e.materielForm,"code",t)},expression:"materielForm.code"}})],1),e._v(" "),i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"型号",prop:"model"}},[i("el-input",{model:{value:e.materielForm.model,callback:function(t){e.$set(e.materielForm,"model",t)},expression:"materielForm.model"}})],1)],1),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"封装",prop:"potting"}},[i("el-input",{model:{value:e.materielForm.potting,callback:function(t){e.$set(e.materielForm,"potting",t)},expression:"materielForm.potting"}})],1),e._v(" "),i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"厂家型号:",prop:"factoryModel"}},[i("el-input",{model:{value:e.materielForm.factoryModel,callback:function(t){e.$set(e.materielForm,"factoryModel",t)},expression:"materielForm.factoryModel"}})],1)],1),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"数量",prop:"quantity"}},[i("el-input",{model:{value:e.materielForm.quantity,callback:function(t){e.$set(e.materielForm,"quantity",t)},expression:"materielForm.quantity"}})],1),e._v(" "),i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"品牌",prop:"brand"}},[i("el-input",{model:{value:e.materielForm.brand,callback:function(t){e.$set(e.materielForm,"brand",t)},expression:"materielForm.brand"}})],1)],1),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"供应商",prop:"supplier"}},[i("el-input",{model:{value:e.materielForm.supplier,callback:function(t){e.$set(e.materielForm,"supplier",t)},expression:"materielForm.supplier"}})],1),e._v(" "),i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"网址",prop:"website"}},[i("el-input",{model:{value:e.materielForm.website,callback:function(t){e.$set(e.materielForm,"website",t)},expression:"materielForm.website"}})],1)],1),e._v(" "),i("div",{staticStyle:{display:"inline-block"}},[i("div",{staticStyle:{float:"left"}},[i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"价格",prop:"price"}},[i("el-input",{model:{value:e.materielForm.price,callback:function(t){e.$set(e.materielForm,"price",t)},expression:"materielForm.price"}})],1)],1),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"备注",prop:"remarks"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:10}},model:{value:e.materielForm.remarks,callback:function(t){e.$set(e.materielForm,"remarks",t)},expression:"materielForm.remarks"}})],1)],1)]),e._v(" "),i("div",{staticStyle:{float:"right"}},[i("el-form-item",{staticClass:"inline-input-width",attrs:{label:"图片",prop:"photo"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","on-change":e.fileChange,"show-file-list":!1,"before-upload":e.beforeAvatarUpload,"auto-upload":!1}},[e.imageUrl?i("img",{staticClass:"avatar",attrs:{src:e.imageUrl,width:"120",height:"120"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)]),e._v(" "),i("div",[i("el-form-item",{staticClass:"inline-input-width"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("materielForm")}}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:function(t){return e.resetForm("materielForm")}}},[e._v("重置")])],1)],1)])],1),e._v(" "),i("el-dialog",{staticClass:"el-dialog__wrap",attrs:{visible:e.isDialogImport,"close-on-click-modal":!1,width:"500px",title:"上传文件"},on:{"update:visible":function(t){e.isDialogImport=t}}},[i("el-form",{staticClass:"form",attrs:{model:e.importForm,"label-width":"100px"}},[i("el-form-item",{staticStyle:{position:"relative"},attrs:{label:"选择文件",prop:"file"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-change":e.fileChangeT,"show-file-list":!1,"auto-upload":!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"}},[i("el-button",{staticStyle:{"background-color":"#dfe3e9"},attrs:{slot:"trigger",size:"small"},slot:"trigger"},[e._v("选择")])],1),e._v(" "),i("span",{staticStyle:{color:"DarkOrange","font-size":"16px"}},[e._v(e._s(e.importForm.file.name))])],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.importNewMaterial}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:function(t){e.isDialogImport=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var l=i("VU/8")(r,a,!1,function(e){i("Luq1")},"data-v-780c2228",null);t.default=l.exports}});
//# sourceMappingURL=6.f8eb7cc6d6337640b18f.js.map